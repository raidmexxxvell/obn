{% extends "layout_base.html" %}
{% block content %}
<div class="page admin-page">
    <h2>Админ-панель</h2>
    
    <div class="admin-stats">
        <div class="stat-card">
            <span class="stat-number">{{ stats.total }}</span>
            <span class="stat-label">Всего пользователей</span>
        </div>
        <div class="stat-card">
            <span class="stat-number">{{ stats.online }}</span>
            <span class="stat-label">Онлайн сейчас</span>
        </div>
        <div class="stat-card">
            <span class="stat-number">{{ stats.today }}</span>
            <span class="stat-label">Новых сегодня</span>
        </div>
        <div class="stat-card">
            <span class="stat-number">{{ stats.week }}</span>
            <span class="stat-label">Новых за неделю</span>
        </div>
    </div>
    
    <div class="admin-tabs">
        <button class="admin-tab active" data-tab="orders">Заказы</button>
        <button class="admin-tab" data-tab="bets">Ставки</button>
        <button class="admin-tab" data-tab="matches">Матчи</button>
        <button class="admin-tab" data-tab="sync">Синхронизация</button>
    </div>
    
    <div class="admin-tab-content active" data-tab-content="orders">
        <h3>Новые заказы</h3>
        <div class="orders-list">
            {% if orders|length == 0 %}
            <p class="no-orders">Нет новых заказов</p>
            {% else %}
            {% for order in orders %}
            <div class="order-card">
                <div class="order-header">
                    <span class="order-user">{{ order.display_name }}</span>
                    <span class="order-date">{{ order.created_at }}</span>
                </div>
                <div class="order-details">
                    <span class="order-item">{{ order.item }}</span>
                    <span class="order-price">{{ order.price }} кредитов</span>
                </div>
                <div class="order-actions">
                    <select class="order-status" data-order-id="{{ order.id }}">
                        <option value="pending" {% if order.status == 'pending' %}selected{% endif %}>В обработке</option>
                        <option value="processing" {% if order.status == 'processing' %}selected{% endif %}>Готовится</option>
                        <option value="shipped" {% if order.status == 'shipped' %}selected{% endif %}>Отправлен</option>
                        <option value="delivered" {% if order.status == 'delivered' %}selected{% endif %}>Доставлен</option>
                        <option value="cancelled" {% if order.status == 'cancelled' %}selected{% endif %}>Отменен</option>
                    </select>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
    
    <div class="admin-tab-content" data-tab-content="bets">
        <h3>Последние ставки</h3>
        <div class="bets-list">
            {% if bets|length == 0 %}
            <p class="no-bets">Нет ставок</p>
            {% else %}
            {% for bet in bets %}
            <div class="bet-card">
                <div class="bet-header">
                    <span class="bet-user">{{ bet.display_name }}</span>
                    <span class="bet-match">{{ bet.team1 }} vs {{ bet.team2 }}</span>
                </div>
                <div class="bet-details">
                    <span class="bet-type">{{ bet.type }}</span>
                    <span class="bet-amount">{{ bet.amount }} кредитов</span>
                    {% if bet.prediction %}
                    <span class="bet-prediction">Прогноз: {{ bet.prediction }}</span>
                    {% endif %}
                </div>
                <div class="bet-status">
                    <span class="status {% if bet.status == 'won' %}status-won{% elif bet.status == 'lost' %}status-lost{% else %}status-active{% endif %}">
                        {% if bet.status == 'won' %}Выиграна{% elif bet.status == 'lost' %}Проиграна{% else %}Активна{% endif %}
                    </span>
                </div>
            </div>
            {% endfor %}
            {% endif %}
        </div>
    </div>
    
    <div class="admin-tab-content" data-tab-content="matches">
        <h3>Управление матчами</h3>
        <div class="matches-list">
            <!-- Список матчей будет загружен через JS -->
            <div id="matches-container">
                <p>Загрузка матчей...</p>
            </div>
        </div>
    </div>
    
    <div class="admin-tab-content" data-tab-content="sync">
        <h3>Синхронизация с Google Sheets</h3>
        <div class="sync-section">
            <p>Нажмите кнопку ниже, чтобы синхронизировать данные с Google Sheets</p>
            <button id="sync-data-btn" class="btn">Обновить данные</button>
            <div id="sync-status" class="sync-status"></div>
        </div>
    </div>
</div>
{% endblock %}